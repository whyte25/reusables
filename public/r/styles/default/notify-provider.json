{
  "name": "notify-provider",
  "type": "registry:ui",
  "dependencies": [
    "framer-motion",
    "class-variance-authority"
  ],
  "registryDependencies": [
    "notify",
    "notify-utils"
  ],
  "files": [
    {
      "path": "reusables/toast/notify-provider.tsx",
      "content": "\"use client\";\n\nimport { cn } from \"@/lib/utils\";\nimport { cva, VariantProps } from \"class-variance-authority\";\nimport { AnimatePresence, motion } from \"framer-motion\";\nimport { useEffect, useMemo, useRef, useState } from \"react\";\nimport { Toast } from \"./notify\";\nimport { toast } from \"./notify-utils\";\n\nexport const DEFAULT_CONFIG = {\n  duration: 4000,\n  position: \"bottom-right\",\n  closable: true,\n  preventDuplicates: false,\n  maxToast: 4,\n  hideProgressBar: false,\n} as const;\n\nconst toastPositionVariants = cva(\"absolute max-w-[420px] w-full p-4 md:p-8 \", {\n  variants: {\n    position: {\n      \"top-left\": \"top-0 md:top-0 left-0\",\n      \"top-center\": \"top-0 md:top-0 left-1/2 transform -translate-x-1/2\",\n      \"top-right\": \"top-0 md:top-0 right-0\",\n      \"bottom-left\": \"bottom-0 md:bottom-0 left-0\",\n      \"bottom-center\":\n        \"bottom-0 md:bottom-0 left-1/2 transform -translate-x-1/2\",\n      \"bottom-right\": \"bottom-0 md:bottom-0 right-0\",\n    },\n  },\n  defaultVariants: {\n    position: DEFAULT_CONFIG.position,\n  },\n});\n\ntype ToastPosition = VariantProps<typeof toastPositionVariants>[\"position\"];\n\ninterface ToastState {\n  dismiss: () => void;\n  id: string;\n  params: ToastParams;\n  position?: ToastPosition;\n}\n\nexport interface ToastParams {\n  closable?: boolean;\n  classNames?: ToastClassNames;\n  description?: React.ReactNode;\n  duration?: number;\n  id?: string;\n  onClose?: () => void;\n  title: string;\n  status?: \"error\" | \"warning\" | \"success\" | \"info\" | \"default\" | \"loading\";\n  loaderVariant?: \"loader-1\" | \"loader-2\";\n  position?: ToastPosition;\n  hideProgressBar?: boolean;\n  preventDuplicates?: boolean;\n  maxToast?: number;\n}\n\nexport interface ToastPromiseOptions<T> {\n  loading: string;\n  success: (data: T) => string;\n  error?: string;\n  position?: ToastPosition;\n  duration?: number;\n  classNames?: ToastClassNames;\n}\n\nexport interface ToastClassNames {\n  error?: string;\n  success?: string;\n  warning?: string;\n  info?: string;\n  loading?: string;\n  closeButton?: string;\n  title?: string;\n  description?: string;\n  loader?: string;\n  progressBar?: string;\n  containerClassName?: string;\n}\n\n// ID Generator\nlet toastId = 0;\nconst generateId = () => String(toastId++);\n\n// Add this interface before the ToastProvider component\nexport interface ToastProviderProps {\n  children: React.ReactNode;\n  position?: ToastPosition;\n  duration?: number;\n  classNames?: ToastClassNames;\n  closable?: boolean;\n  preventDuplicates?: boolean;\n  maxToast?: number;\n  hideProgressBar?: boolean;\n}\n\n// Provider Component\nexport function ToastProvider({\n  children,\n  position: defaultPosition = DEFAULT_CONFIG.position,\n  duration = DEFAULT_CONFIG.duration,\n  classNames = {},\n  closable = DEFAULT_CONFIG.closable,\n  preventDuplicates = DEFAULT_CONFIG.preventDuplicates,\n  maxToast = DEFAULT_CONFIG.maxToast,\n  hideProgressBar = DEFAULT_CONFIG.hideProgressBar,\n}: ToastProviderProps) {\n  const [toasts, setToasts] = useState<ToastState[]>([]);\n  const toastsRef = useRef<{ [key: string]: NodeJS.Timeout }>({});\n\n  // Optimized grouping of toasts by position\n  const toastsByPosition = useMemo(() => {\n    const positions = {} as Record<string, ToastState[]>;\n    for (const toast of toasts) {\n      const position = toast.params.position ?? defaultPosition;\n      positions[position!] = positions[position!] || [];\n      positions[position!].push(toast);\n    }\n    return positions;\n  }, [toasts, defaultPosition]);\n\n  // Using void operator since we only care about the side-effect of setting up handlers\n  // and not the returned value from useMemo\n  void useMemo(() => {\n    const createDismiss = (id: string) => () => {\n      setToasts((prev) => prev.filter((t) => t.id !== id));\n      if (toastsRef.current[id]) {\n        clearTimeout(toastsRef.current[id]);\n        delete toastsRef.current[id];\n      }\n    };\n\n    const push = (params: ToastParams) => {\n      const id = params.id ?? generateId();\n      const toastDuration = params.duration ?? duration;\n\n      // Check for duplicates if preventDuplicates is enabled\n      if (params.preventDuplicates ?? preventDuplicates) {\n        const isDuplicate = toasts.some(\n          (toast) => toast.params.title === params.title\n        );\n        if (isDuplicate) return id;\n      }\n\n      const dismiss = createDismiss(id);\n\n      setToasts((prev) => {\n        // Remove oldest toasts if exceeding maxToast\n        const filteredToasts = prev.filter((t) => t.id !== id);\n        const newToast = {\n          dismiss,\n          id,\n          params: {\n            ...params,\n            duration: toastDuration,\n            closable: params.closable ?? closable,\n            hideProgressBar: params.hideProgressBar ?? hideProgressBar,\n            classNames,\n            position: params.position ?? defaultPosition,\n          },\n        };\n\n        const updatedToasts = [newToast, ...filteredToasts];\n        return updatedToasts.slice(0, params.maxToast ?? maxToast);\n      });\n\n      if (toastsRef.current[id]) {\n        clearTimeout(toastsRef.current[id]);\n      }\n\n      if (toastDuration !== Infinity) {\n        toastsRef.current[id] = setTimeout(dismiss, toastDuration);\n      }\n\n      return id;\n    };\n\n    const pushPromise = <T,>(\n      promise: () => Promise<T>,\n      options: ToastPromiseOptions<T>\n    ) => {\n      const id = generateId();\n      const dismiss = createDismiss(id);\n      const position = options.position;\n      const toastDuration = options.duration ?? duration;\n      const toastClassNames = options.classNames ?? classNames;\n\n      push({\n        status: \"loading\",\n        title: options.loading,\n        id,\n        position,\n        classNames: toastClassNames,\n        duration: toastDuration,\n      });\n\n      promise()\n        .then((data) => {\n          setToasts((prev) => [\n            {\n              dismiss,\n              id,\n              params: {\n                status: \"success\",\n                title: options.success(data),\n                duration: toastDuration,\n                closable: true,\n                classNames: toastClassNames,\n                position,\n                hideProgressBar: hideProgressBar,\n              },\n            },\n            ...prev.filter((t) => t.id !== id),\n          ]);\n        })\n        .catch((error) => {\n          setToasts((prev) => [\n            {\n              dismiss,\n              id,\n              params: {\n                status: \"error\",\n                title: options.error ?? \"Error\",\n                duration: toastDuration,\n                classNames: toastClassNames,\n                position,\n                hideProgressBar: hideProgressBar,\n              },\n            },\n            ...prev.filter((t) => t.id !== id),\n          ]);\n        });\n\n      return id;\n    };\n\n    toast.setHandlers(push, pushPromise);\n    return toast;\n  }, [\n    duration,\n    classNames,\n    closable,\n    defaultPosition,\n    preventDuplicates,\n    maxToast,\n    hideProgressBar,\n    toasts,\n  ]);\n\n  useEffect(() => {\n    return () => {\n      Object.values(toastsRef.current).forEach(clearTimeout);\n      toastsRef.current = {};\n    };\n  }, []);\n\n  return (\n    <>\n      {children}\n      <div\n        role=\"alert\"\n        aria-live=\"polite\"\n        className=\"fixed inset-0 pointer-events-none z-[999999]\"\n      >\n        {Object.entries(toastsByPosition).map(([position, positionToasts]) => (\n          <div\n            key={position}\n            className={cn(\n              toastPositionVariants({\n                position: position as ToastPosition,\n              }),\n              classNames.containerClassName\n            )}\n          >\n            <AnimatePresence>\n              {positionToasts.map(({ dismiss, id, params }, index) => {\n                const isTop = position?.includes(\"top\");\n                return (\n                  <motion.div\n                    key={id}\n                    layout\n                    initial={{ opacity: 0, y: isTop ? -80 : 80, scale: 0.85 }}\n                    animate={{ opacity: 1, y: 0, scale: 1 }}\n                    exit={{\n                      opacity: 0,\n                      scale: 0.5,\n                      y: isTop ? -80 : 80,\n                      transition: { duration: 0.2 },\n                    }}\n                    transition={{}}\n                    className=\"mb-3.5 last:mb-0 pointer-events-auto\"\n                    style={{\n                      zIndex: positionToasts.length - index,\n                    }}\n                  >\n                    <Toast {...params} onClose={dismiss} />\n                  </motion.div>\n                );\n              })}\n            </AnimatePresence>\n          </div>\n        ))}\n      </div>\n    </>\n  );\n}\n\nexport { toast };\n",
      "type": "registry:ui",
      "target": ""
    }
  ]
}